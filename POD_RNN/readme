This code presents the application of flow past a cylinder using POD-RNN hybrid deep learning ROM. 
Link to the paper: https://arxiv.org/abs/2009.04396
Authors: R.Gupta, S.R.Bukka		


The code is written in MATLAB R2019a-academic version, which utilies the MATLAB "Deep Learning" toolbox. 

To use the code follow the steps in order: 

#1. Run the matlab script "pod.m" that uses the full-order data from "full_order_cyl_data" directory to generate the spatial POD modes and time-coefficients. 
Note that the full-order data in the "full_order_cyl_data" are provided in a seperate link as three *.mat files: 
-"crd_rb.mat" : mat file containing x and y coordinate info from FE simulation 
-"pres_rb.mat": mat file containing nodal pressure data in time 
-"vel_rb.mat" : mat file containing nodal x and y velocity data in time 
Make sure that the above mat files are present in the "full_order_cyl_data" before running the script "pod.m". 

#2. [Optional] Use the script "lstmrecurrent.m" to train and predict time-coefficients generated from #1, in closed-loop fashion.
You can skip this step and use the predicted coefficients that are already provided in the current directory:
"y_pred_n_pres.mat" : time-series prediction (pressure) 
"y_pred_n_velx.mat" : time-series prediction (x-velocity)

#3. "modal_plot.m" The predicted and actual coefficients can be visualised from this script. 

#4. Finally run "reconstruction.m" to use the predicted coefficients to visualise the flow field and reconstruction error. 
If everything is done correctly, the code reconstructs the generated predicted field data in "P_recon.mat" file. 

(Use step #5 only for pressure fields)
#5. The pressure force coefficients can be generated by accessing "IntegratedOutput.m" in the "Force" directory. 
This script uses the predicted pressure field from "P_recon.mat" and carries numerical integration on the cylinder boundary.
Full-order mesh details are provided in "Data_rigid_cylv3.mat".    
